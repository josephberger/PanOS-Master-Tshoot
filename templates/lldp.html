{% extends "base.html" %}

{% block title %}MT-Mapper - LLDP Neighbors{% endblock %}
{% block pagename %}LLDP Neighbors{% endblock %}

{% block head_content %}
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/lldp-styles.css') }}">
{% endblock %}

{% block content %}
<div id="app-container">
    <div class="controls">
        <div id="controls-header">
            <strong><span id="menu-toggle-icon">«</span> Menu</strong>
        </div>
        <div id="controls-body">
            {# The main controls remain here #}
            <div id="main-controls">
                <button id="loadAllLldpBtn" class="button-primary">Load All LLDP Maps</button>
                <button id="toggleAllNodesLockBtn" class="button-secondary" style="margin-top: 5px;">Lock All Nodes</button>
                <label for="ngfwSelector">Single NGFW View</label>
                <select id="ngfwSelector"></select>
                
                <hr class="section-divider">
                <label for="searchInput">Search Current View</label>
                <input type="text" id="searchInput" placeholder="e.g., Hostname, eth1/1">
                <div class="button-group">
                    <button id="resetViewBtn" class="button-secondary">Reset View</button>
                    <button id="exportSvgBtn" class="button-secondary">Export to SVG</button>
                </div>
            </div>

            <hr class="section-divider">

            <div id="add-manual-neighbor-section">
                <h5>Add Manual LLDP Neighbor</h5>
                <form id="add-lldp-neighbor-form">
                    <label for="addNgfwHostname">NGFW Hostname</label>
                    <select id="addNgfwHostname" required></select>

                    <label for="addLocalInterface">NGFW Interface</label>
                    <input type="text" id="addLocalInterface" placeholder="e.g., ethernet1/1" required>

                    <label for="addRemoteHostname">Remote Hostname</label>
                    <input type="text" id="addRemoteHostname" placeholder="e.g., Core-Switch" required>

                    <label for="addRemoteInterfaceId">Remote Interface ID</label>
                    <input type="text" id="addRemoteInterfaceId" placeholder="e.g., Gi0/1, Port 1" required>

                    <label for="addRemoteInterfaceDescription">Remote Interface Description</label>
                    <input type="text" id="addRemoteInterfaceDescription" placeholder="e.g., Core SW to FW Link" required>

                    <button type="submit" class="button-primary">Add Neighbor</button>
                </form>
            </div>
        </div>
    </div>
    <div id="visualization"></div>

    {# NEW: Inspector Panel is now outside of 'controls' and positioned absolutely #}
    <div id="inspector-panel">
        <div class="modal-header">
            <h4 id="inspector-title"></h4>
            <button id="inspector-close-btn" data-dashlane-label="true" data-dashlane-rid="f1d706526c26436d">×</button>
        </div>
        <div id="inspector-content"></div>
    </div>

    {# NEW: Overlay for when inspector is open #}
    <div id="inspector-overlay" class="hidden"></div>
</div>
<div class="tooltip"></div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='scripts/main-lldp-app.js') }}"></script>
<script src="{{ url_for('static', filename='scripts/draw-single-lldp-map.js') }}"></script>
<script src="{{ url_for('static', filename='scripts/draw-global-lldp-map.js') }}"></script>
{% endblock %}